import{J as Q,O as c,k as W,s as K,o as d,y as w,a as $,W as e,Q as r,C as U,i as s,b as X,M as h,e as Y,E as Z,F as z,L as g,x as k}from"./index-4eac733d.js";const ee=(n,i)=>k.get(`/admin/product/baseTrademark/${n}/${i}`),ae=n=>n.id?k.put("/admin/product/baseTrademark/update",n):k.post("/admin/product/baseTrademark/save",n),le=n=>k.delete(`/admin/product/baseTrademark/remove/${n}`),te=["src"],re=["src"],oe=Q({__name:"index",setup(n){let i=c(1),f=c(3),x=c(0),b=c([]),u=c(!1),o=W({tmName:"",logoUrl:""}),m=c();const v=async(a=1)=>{i.value=a;let l=await ee(i.value,f.value);l.code==200&&(x.value=l.data.total,b.value=l.data.records,console.log(b))};K(()=>{v()});const N=()=>{v()},E=()=>{u.value=!0,o.id=0,o.tmName="",o.logoUrl="",z(()=>{m.value.clearValidate("tmName"),m.value.clearValidate("logoUrl")})},O=a=>{z(()=>{m.value.clearValidate("tmName"),m.value.clearValidate("logoUrl")}),u.value=!0,Object.assign(o,a)},G=()=>{u.value=!1},F=async()=>{await m.value.validate();let a=await ae(o);console.log(a.code),a.code==200?(u.value=!1,g({type:"success",message:o.id?"修改品牌成功":"添加品牌成功"}),v(o.id?i.value:1)):(g({type:"error",message:o.id?"修改品牌失败":"添加品牌失败"}),u.value=!1)},L=a=>a.type=="image/png"||a.type=="image/jpg"||a.type=="image/gif"?a.size/1024/1024<=4?!0:(g({type:"error",message:"上传文件大小小于4M"}),!1):(g({type:"error",message:"上传文件格式务必PNG|JPG|GIF"}),!1),P={tmName:[{required:!0,trigger:"blur",validator:(a,l,p)=>{l.trim().length>=2?p():p(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,validator:(a,l,p)=>{l?p():p(new Error("LOGO图片务必上传"))}}]},T=(a,l)=>{o.logoUrl=a.data,m.value.clearValidate("logoUrl")},j=async a=>{(await le(a)).code==200?(g({type:"success",message:"删除品牌成功"}),v(b.value.length>1?i.value:i.value-1)):g({type:"error",message:"删除品牌失败"})};return(a,l)=>{const p=d("Plus"),C=d("el-icon"),y=d("el-button"),_=d("el-table-column"),J=d("el-popconfirm"),M=d("el-table"),S=d("el-pagination"),q=d("el-card"),D=d("el-input"),V=d("el-form-item"),I=d("el-upload"),R=d("el-form"),A=d("el-dialog");return w(),$("div",null,[e(q,{class:"box-card"},{default:r(()=>[e(y,{type:"primary",onClick:E},{default:r(()=>[e(C,null,{default:r(()=>[e(p)]),_:1}),U(" 添加品牌 ")]),_:1}),e(M,{data:s(b),style:{margin:"10px 0",width:"100%"},border:""},{default:r(()=>[e(_,{label:"序号",width:"80px",align:"center",type:"index"}),e(_,{prop:"tmName",label:"品牌名称",align:"center"}),e(_,{prop:"name",label:"品牌logo",align:"center"},{default:r(({row:t,$index:B})=>[X("img",{src:t.logoUrl,style:{width:"100px",height:"100px"}},null,8,te)]),_:1}),e(_,{prop:"address",label:"操作说明",align:"center"},{default:r(({row:t,$index:B})=>[e(y,{type:"primary",size:"small",icon:"Edit",onClick:H=>O(t)},null,8,["onClick"]),e(J,{title:`您确定要删除${t.tmName}?`,width:"250px",icon:"Delete",onConfirm:H=>j(t.id)},{reference:r(()=>[e(y,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(S,{"current-page":s(i),"onUpdate:currentPage":l[0]||(l[0]=t=>h(i)?i.value=t:i=t),"page-size":s(f),"onUpdate:pageSize":l[1]||(l[1]=t=>h(f)?f.value=t:f=t),"page-sizes":[3,5,7,9],background:a.background,layout:" prev, pager,next,jumper,->,sizes,total",total:s(x),onSizeChange:N,onCurrentChange:v},null,8,["current-page","page-size","background","total"])]),_:1}),e(A,{modelValue:s(u),"onUpdate:modelValue":l[3]||(l[3]=t=>h(u)?u.value=t:u=t),title:s(o).id?"修改品牌":"添加品牌"},{footer:r(()=>[e(y,{type:"primary",size:"default",onClick:G},{default:r(()=>[U(" 取消 ")]),_:1}),e(y,{type:"primary",size:"default",onClick:F},{default:r(()=>[U(" 确定 ")]),_:1})]),default:r(()=>[e(R,{style:{width:"80%"},model:s(o),rules:P,ref_key:"formRef",ref:m},{default:r(()=>[e(V,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:r(()=>[e(D,{placeholder:"请您输入品牌名称",modelValue:s(o).tmName,"onUpdate:modelValue":l[2]||(l[2]=t=>s(o).tmName=t)},null,8,["modelValue"])]),_:1}),e(V,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:r(()=>[e(I,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!0,"on-success":T,"before-upload":L},{default:r(()=>[s(o).logoUrl?(w(),$("img",{key:0,src:s(o).logoUrl,class:"avatar"},null,8,re)):(w(),Y(C,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[e(p)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ie=Z(oe,[["__scopeId","data-v-b2e0fa1c"]]);export{ie as default};
