import{J as k,d as K,r as c,b as Q,B as W,c as n,o as x,e as z,f as a,w as o,j as U,g as d,h as X,L as N,n as Y,v as w,M as _,_ as Z}from"./index-9585324e.js";const ee=(u,s)=>k.get(`/admin/product/baseTrademark/${u}/${s}`),ae=u=>u.id?k.put("/admin/product/baseTrademark/update",u):k.post("/admin/product/baseTrademark/save",u),le=u=>k.delete(`/admin/product/baseTrademark/remove/${u}`),te=["src"],oe=["src"],re=K({__name:"index",setup(u){let s=c(1),g=c(3),T=c(0),y=c([]),i=c(!1),r=Q({tmName:"",logoUrl:""}),p=c();const f=async(l=1)=>{s.value=l;let e=await ee(s.value,g.value);e.code==200&&(T.value=e.data.total,y.value=e.data.records,console.log(y))};W(()=>{f()});const h=()=>{f()},q=()=>{i.value=!0,r.id=0,r.tmName="",r.logoUrl="",w(()=>{p.value.clearValidate("tmName"),p.value.clearValidate("logoUrl")})},O=l=>{w(()=>{p.value.clearValidate("tmName"),p.value.clearValidate("logoUrl")}),i.value=!0,Object.assign(r,l)},P=()=>{i.value=!1},E=async()=>{await p.value.validate();let l=await ae(r);console.log(l.code),l.code==200?(i.value=!1,_({type:"success",message:r.id?"修改品牌成功":"添加品牌成功"}),f(r.id?s.value:1)):(_({type:"error",message:r.id?"修改品牌失败":"添加品牌失败"}),i.value=!1)},G=l=>l.type=="image/png"||l.type=="image/jpg"||l.type=="image/gif"?l.size/1024/1024<=4?!0:(_({type:"error",message:"上传文件大小小于4M"}),!1):(_({type:"error",message:"上传文件格式务必PNG|JPG|GIF"}),!1),L={tmName:[{required:!0,trigger:"blur",validator:(l,e,m)=>{e.trim().length>=2?m():m(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,validator:(l,e,m)=>{e?m():m(new Error("LOGO图片务必上传"))}}]},M=(l,e)=>{r.logoUrl=l.data,p.value.clearValidate("logoUrl")},$=async l=>{(await le(l)).code==200?(_({type:"success",message:"删除品牌成功"}),f(y.value.length>1?s.value:s.value-1)):_({type:"error",message:"删除品牌失败"})};return(l,e)=>{const m=n("Plus"),V=n("el-icon"),v=n("el-button"),b=n("el-table-column"),j=n("el-popconfirm"),A=n("el-table"),B=n("el-pagination"),D=n("el-card"),R=n("el-input"),C=n("el-form-item"),S=n("el-upload"),H=n("el-form"),I=n("el-dialog");return x(),z("div",null,[a(D,{class:"box-card"},{default:o(()=>[a(v,{type:"primary",onClick:q},{default:o(()=>[a(V,null,{default:o(()=>[a(m)]),_:1}),e[4]||(e[4]=U(" 添加品牌 ",-1))]),_:1}),a(A,{data:d(y),style:{margin:"10px 0",width:"100%"},border:""},{default:o(()=>[a(b,{label:"序号",width:"80px",align:"center",type:"index"}),a(b,{prop:"tmName",label:"品牌名称",align:"center"}),a(b,{prop:"name",label:"品牌logo",align:"center"},{default:o(({row:t,$index:J})=>[X("img",{src:t.logoUrl,style:{width:"100px",height:"100px"}},null,8,te)]),_:1}),a(b,{prop:"address",label:"操作说明",align:"center"},{default:o(({row:t,$index:J})=>[a(v,{type:"primary",size:"small",icon:"Edit",onClick:F=>O(t)},null,8,["onClick"]),a(j,{title:`您确定要删除${t.tmName}?`,width:"250px",icon:"Delete",onConfirm:F=>$(t.id)},{reference:o(()=>[a(v,{type:"primary",size:"small",icon:"Delete"})]),_:1},8,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a(B,{"current-page":d(s),"onUpdate:currentPage":e[0]||(e[0]=t=>N(s)?s.value=t:s=t),"page-size":d(g),"onUpdate:pageSize":e[1]||(e[1]=t=>N(g)?g.value=t:g=t),"page-sizes":[3,5,7,9],background:l.background,layout:" prev, pager,next,jumper,->,sizes,total",total:d(T),onSizeChange:h,onCurrentChange:f},null,8,["current-page","page-size","background","total"])]),_:1}),a(I,{modelValue:d(i),"onUpdate:modelValue":e[3]||(e[3]=t=>N(i)?i.value=t:i=t),title:d(r).id?"修改品牌":"添加品牌"},{footer:o(()=>[a(v,{type:"primary",size:"default",onClick:P},{default:o(()=>[...e[5]||(e[5]=[U(" 取消 ",-1)])]),_:1}),a(v,{type:"primary",size:"default",onClick:E},{default:o(()=>[...e[6]||(e[6]=[U(" 确定 ",-1)])]),_:1})]),default:o(()=>[a(H,{style:{width:"80%"},model:d(r),rules:L,ref_key:"formRef",ref:p},{default:o(()=>[a(C,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:o(()=>[a(R,{placeholder:"请您输入品牌名称",modelValue:d(r).tmName,"onUpdate:modelValue":e[2]||(e[2]=t=>d(r).tmName=t)},null,8,["modelValue"])]),_:1}),a(C,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:o(()=>[a(S,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!0,"on-success":M,"before-upload":G},{default:o(()=>[d(r).logoUrl?(x(),z("img",{key:0,src:d(r).logoUrl,class:"avatar"},null,8,oe)):(x(),Y(V,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[a(m)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const ie=Z(re,[["__scopeId","data-v-b2e0fa1c"]]);export{ie as default};
